package com.example.atividades.atividade15;

import static org.junit.jupiter.api.Assertions.*;
import org.junit.jupiter.api.Test;
import static org.mockito.Mockito.*;

import software.amazon.awssdk.services.rekognition.RekognitionClient;
import software.amazon.awssdk.services.rekognition.model.*;

import java.io.InputStream;

public class TestDetectTextImage {

    @Test
    public void testDetectTextLabels() {
        // Criar um mock para RekognitionClient
        RekognitionClient mockRekClient = mock(RekognitionClient.class);

        // Obter o InputStream da imagem
        InputStream inputStream = getClass().getResourceAsStream("java.jpg");

        // Criar uma instância de DetectTextImage com o mock RekognitionClient e o InputStream da imagem
        DetectTextImage detectTextImage = new DetectTextImage(inputStream, mockRekClient);

        // Criar um objeto DetectTextResponse vazio para simular o retorno do método detectText
        DetectTextResponse emptyResponse = DetectTextResponse.builder().build();

        // Simular o comportamento do método detectText para resolver a ambiguidade
        when(mockRekClient.detectText(any(DetectTextRequest.class))).thenReturn(emptyResponse);

        // Chamar o método detectTextLabels
        String resultFilePath = "data/test-result.txt";
        detectTextImage.detectTextLabels(resultFilePath);

        // Verificar se o método detectText do RekognitionClient foi chamado corretamente
        verify(mockRekClient, times(1)).detectText(any(DetectTextRequest.class));
    }
}

